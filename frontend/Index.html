<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Language" content="en" />
    <meta name='description'
        content='CSS & JavaScript minifier. We remove whitespace, strips, comments. For this app we use a few common programming patterns for optimizes/shortens.' />
    <meta name='keywords'
        content='css, js, javascript, minifier, shorten, optimize, minify, programming, coding, optimization, frontend, front-end' />

    <script src="https://kit.fontawesome.com/83fc83593c.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.5.0/knockout-min.js"></script>
    <link rel="shortcut icon" href="icon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/custom.css">
    <title>Exchange rate </title>

    <!-- Global site tag (gtag.js) - Google Analytics -->


</head>

<body onload="LoadTableData()">
    
<!-- Navigation menu -->
<div class="container text-color">
        <div class="row">
                <div class="twelve columns">
                       <p class="u-pull-left">Currency exchange </p>
                       <p class="u-pull-right "><a class="language-link"href="#">MK</a>/<a class="language-link" href="#">ENG</a></p>
                       
                </div>
            
             </div>

     <div class="row">
        <div class="twelve columns">
                <ul class="navigation">
                  <li class="active"><a href="index.html">List</a></li>
                    <li><a href="converter.html">converter</a></li>
                    <li><a href="history.html">History</a></li>
                </ul>
        </div>
     </div>

     <div class="row">
         <h4 style="margin-top: 2rem;">Exchange rate of denar on 14/07/2019</h4>
            <div class="twelve columns">
                    <table class="u-full-width " id="CurrencyTable">
                            <thead>
                              <tr>
                                <th>Flag</th>
                                <th>Country</th>
                                <th>Currency</th>
                                <th>Value</th>
                                
                              </tr>
                            </thead>
                            <tbody>
                             
                            </tbody>
                          </table>
                          <p>Data was last time updated on 14/07/2019</p>

           </div>
     </div>

     <div class="row footer">
        <div class="twelve columns">
            <p class="u-pull-left"><a class="language-link"href="#">privacy policy </a></p>
            <p class="u-pull-right "><a class="language-link"href="#"><i class="fas fa-moon theme-active"></i></a>/
              <a class="language-link" href="#"><i class="fas fa-sun"></i></a>
            </p>
      </div>
     

</div>

<!-- The Modal -->
<div id="myModal" class="modal">
  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
    <p id="modalText" style="text-align:center">Some text in the Modal..</p>
  </div>

</div>

<script>

  var data;
  
  async function LoadTableData()
  {
    let response = await fetch("https://valuta.php.mk/api/list");
  
    if (response.ok) 
    { // if HTTP-status is 200-299
      // get the response body (see below)
      let json = await response.json();
      console.log(json);
      data = json.data;
      FillTable(data)
  
    } 
    else 
    {
      
    }
  }

  function FillTable(data)
  {
    var Ctable = document.getElementById('CurrencyTable');


    for(var i = 0;i < data.length;i++)
    {
      //html += "<a id='" + id1 +"'>link</a>";

      var row = Ctable.insertRow(-1);

      var cell1 = row.insertCell(0);
      var cell2 = row.insertCell(1);
      var cell3 = row.insertCell(2);
      var cell4 = row.insertCell(3);

      cell1.innerHTML = "<img class='CountryImg' src='images/"+ data[i].drzava_en.toLowerCase() +".png'>";
      cell2.innerHTML = data[i].drzava_en;
      cell3.innerHTML = data[i].valuta_en;
      var float = parseFloat(data[i].kupoven, 10);
      cell4.innerHTML = "<span id='tt"+ i +"'>" + float.toFixed(2) + "<i class='fas fa-info-circle table-info-icon' id='tooltip"+ i +"'></i></span>";
      
      //click event for showing modal
      document.getElementById("tt"+i).addEventListener("click", function(e) 
      {
        var tempi = e.target.id.slice(2, 3); // Get id from clicked element
        var modalText = document.getElementById("modalText");
        modalText.innerHTML = "Prodazen: "+ parseFloat(data[tempi].prodazen,10).toFixed(2) + "</br>" + "Sreden: " + parseFloat(data[tempi].sreden,10).toFixed(2);
        modal.style.display = "block";
        
       });
      
    }

  }

  // Get the modal
var modal = document.getElementById("myModal");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}



  </script>


</body>

</html>