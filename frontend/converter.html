<!DOCTYPE html>
<html lang="mk">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="Content-Language" content="en"/>
    <meta name='description' content=""/>


    <meta name='keywords'
          content='css, js, javascript, minifier, shorten, optimize, minify, programming, coding, optimization, frontend, front-end'/>

    <script src="https://kit.fontawesome.com/83fc83593c.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/knockout/3.5.0/knockout-min.js"></script>
    <link rel="shortcut icon" href="icon.ico" type="image/x-icon"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/skeleton.css">
    <link rel="stylesheet" href="css/custom.css">
    <title>Exchange rate </title>

</head>

<body onload="LoadDropDownData()">

<h1 id="description">sfgsf</h1>
<!-- Navigation menu -->
<div class="container text-color">
    <div class="row">
        <div class="twelve columns">
            <p class="u-pull-left">Currency exchange</p>
            <p class="u-pull-right "><a class="language-link" href="#">MK</a>/<a class="language-link" href="#">ENG</a>
            </p>

        </div>

    </div>

    <div class="row">
        <div class="twelve columns">
            <ul class="navigation">
                <li><a href="index.html">List</a></li>
                <li><a href="converter.html">converter</a></li>
                <li><a href="history.html">History</a></li>
            </ul>
        </div>
    </div>

    <form style="margin-top:5rem;">
        <div class="row">
            <div class="three columns">
                <label for="Amount">Amount</label>
                <input class="u-full-width input-size" type="number" placeholder="Amount" id="Amount"
                       style="Color:black;">
            </div>
            <div class="three columns">
                <label for="FromC">From</label>
                <select class="u-full-width input-size" id="FromC" style="Color:black;">
                    <option value="mkd">MKD</option>
                </select>
            </div>
            <div class="three columns">
                <label for="ToC">To</label>
                <select class="u-full-width input-size" id="ToC" style="Color:black;">
                    <option value="mkd">MKD</option>
                </select>
            </div>
            <div class="two columns">
                <label for="ToC" style="color:black;">To</label>
                <input class="button-primary input-size" type="button" onclick="Convert()" value="Convert">
            </div>
        </div>
    </form>

    <div class="row">
        <div class="twelve columns" style="border:2px solid white">
            <p style="text-align: center;font-size: 2rem;padding-top: 2rem;" id="Fresult">0</p>
        </div>
    </div>

    <div class="row footer">
        <div class="twelve columns">
            <p class="u-pull-left"><a class="language-link" href="#">privacy policy </a></p>
            <p class="u-pull-right "><a class="language-link" href="#"><i class="fas fa-moon theme-active"></i></a>/
                <a class="language-link" href="#"><i class="fas fa-sun"></i></a>
            </p>
        </div>
    </div>

    <p id="demo"></p>
</div>

<script src="js/apexcharts.js"></script>
<script>

    var data;

    async function LoadDropDownData() {
        let response = await fetch("https://valuta.php.mk/api/list");

        if (response.ok) { // if HTTP-status is 200-299
            // get the response body (see below)
            let json = await response.json();
            //console.log(json);
            data = json.data;
            FillDropDownData(data);


        } else {

        }
    }

    async function LoadConvertData(FirstCurrency, SecondCurrency, Amount) {
        var Concat = 'https://valuta.php.mk/api/converter/' + FirstCurrency + '/' + SecondCurrency + '/' + Amount;

        let response = await fetch(Concat);

        if (response.ok) { // if HTTP-status is 200-299
            // get the response body (see below)
            let json = await response.json();
            var float = parseFloat(json.data.price, 10);
            document.getElementById('Fresult').innerHTML = float.toFixed(4);
        } else {

        }
    }

    function FillDropDownData(data) {

        // get reference to select element
        var sel1 = document.getElementById('FromC');
        var sel2 = document.getElementById('ToC');

        for (var i = 0; i < data.length; i++) {

            // create new option element
            var opt1 = document.createElement('option');
            var opt2 = document.createElement('option');

            // create text node to add to option element (opt)
            opt1.appendChild(document.createTextNode(data[i].oznaka));
            opt2.appendChild(document.createTextNode(data[i].oznaka));
            // set value property of opt
            opt1.value = data[i].oznaka;
            opt2.value = data[i].oznaka;

            // add opt to end of select box (sel)
            sel1.appendChild(opt1);
            sel2.appendChild(opt2);
        }

    }

    function Convert() {

        var CurrencyOneSelect = document.getElementById("FromC");
        var CurrencyOneValue = CurrencyOneSelect.options[CurrencyOneSelect.selectedIndex].value;

        var CurrencyTwoSelect = document.getElementById("ToC");
        var CurrencyTwoValue = CurrencyTwoSelect.options[CurrencyTwoSelect.selectedIndex].value;

        var Amount = document.getElementById("Amount").value;

        LoadConvertData(CurrencyOneValue, CurrencyTwoValue, Amount);

    }

</script>
<script src="js/localization.js"></script>
</body>
</html>